import numpy as np


def psiFromCSV(fileName):
    """
    Takes the path of a .csv-file as input. The last column is presumed to
    encode the "n"-vector enumerating the occurrance of different haplotypes;
    The other columns are presuemd to encode haplotypes.

    If the below were the context of myPhi.csv:
    "
    0, 1, 1, 0, 0, 2, 0, 0, 3, 3, 22
    0, 0, 2, 1, 0, 3, 0, 0, 2, 1, 18
    1, 0, 1, 0, 0, 2, 0, 0, 0, 0, 12
    0, 1, 1, 0, 2, 2, 0, 0, 3, 3, 6
    0, 1, 1, 0, 0, 2, 0, 0, 0, 3, 6
    1, 2, 1, 0, 0, 0, 2, 0, 0, 0, 4
    1, 1, 1, 3, 0, 3, 0, 0, 3, 3, 3
    1, 1, 1, 0, 0, 2, 0, 0, 3, 3, 3
    0, 1, 1, 2, 0, 2, 0, 0, 3, 3, 3
    1, 0, 1, 1, 2, 2, 0, 0, 0, 0, 3
    0, 1, 1, 0, 2, 2, 0, 1, 3, 3, 3
    0, 3, 1, 0, 0, 2, 0, 0, 3, 3, 3
    3, 1, 1, 0, 0, 2, 0, 2, 3, 3, 3
    0, 3, 1, 1, 0, 3, 0, 0, 0, 1, 2
    1, 0, 1, 0, 0, 2, 1, 0, 0, 0, 2
    0, 0, 1, 1, 2, 3, 0, 0, 2, 1, 2
    0, 0, 1, 1, 0, 3, 0, 0, 0, 1, 1
    0, 0, 2, 1, 0, 3, 0, 0, 0, 1, 1
    1, 0, 1, 1, 2, 0, 0, 0, 0, 0, 1
    1, 1, 1, 3, 0, 3, 0, 3, 3, 3, 1
    3, 2, 2, 1, 0, 3, 0, 0, 0, 1, 1
    "
    Then psiFromCSV(fileName) would return S,n whereby:

    >>> S
    array([[0, 1, 1, 0, 0, 2, 0, 0, 3, 3],
       [0, 0, 2, 1, 0, 3, 0, 0, 2, 1],
       [1, 0, 1, 0, 0, 2, 0, 0, 0, 0],
       [0, 1, 1, 0, 2, 2, 0, 0, 3, 3],
       [0, 1, 1, 0, 0, 2, 0, 0, 0, 3],
       [1, 2, 1, 0, 0, 0, 2, 0, 0, 0],
       [1, 1, 1, 3, 0, 3, 0, 0, 3, 3],
       [1, 1, 1, 0, 0, 2, 0, 0, 3, 3],
       [0, 1, 1, 2, 0, 2, 0, 0, 3, 3],
       [1, 0, 1, 1, 2, 2, 0, 0, 0, 0],
       [0, 1, 1, 0, 2, 2, 0, 1, 3, 3],
       [0, 3, 1, 0, 0, 2, 0, 0, 3, 3],
       [3, 1, 1, 0, 0, 2, 0, 2, 3, 3],
       [0, 3, 1, 1, 0, 3, 0, 0, 0, 1],
       [1, 0, 1, 0, 0, 2, 1, 0, 0, 0],
       [0, 0, 1, 1, 2, 3, 0, 0, 2, 1],
       [0, 0, 1, 1, 0, 3, 0, 0, 0, 1],
       [0, 0, 2, 1, 0, 3, 0, 0, 0, 1],
       [1, 0, 1, 1, 2, 0, 0, 0, 0, 0],
       [1, 1, 1, 3, 0, 3, 0, 3, 3, 3],
       [3, 2, 2, 1, 0, 3, 0, 0, 0, 1]])
    >>> n
    array([22, 18, 12,  6,  6,  4,  3,  3,  3,  3,  3,  3,  3,  2,  2,  2,  1,
        1,  1,  1,  1])
    """
    raw = np.genfromtxt(fileName, delimiter=',')
    n = np.array(raw[:,-1], dtype = int)
    S = np.array(raw[:,:-1], dtype = int)
    return S,n
